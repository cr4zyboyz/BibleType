<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bible Type</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #1e1e1e;
    color: white;
}

/* HOME */
#home, #results {
    height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 20px;
}

button {
    font-size: 20px;
    padding: 12px 26px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
}

/* GAME */
#game { display: none; }

#track {
    height: 60vh;
    background: linear-gradient(#555, #444);
    border-top: 6px dashed #ccc;
    position: relative;
}

#car {
    position: absolute;
    bottom: 20px;
    left: 20px;
    font-size: 48px;
    transition: left 0.1s linear;
}

#typing {
    height: 40vh;
    background: #111;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

#verse {
    max-width: 90%;
    font-size: 20px;
    text-align: center;
    margin-bottom: 10px;
}

.correct { color: #7fff00; }
.incorrect { color: #ff5555; }

#input {
    width: 90%;
    max-width: 600px;
    font-size: 20px;
    padding: 10px;
    text-align: center;
    border-radius: 6px;
    border: none;
}
</style>
</head>

<body>

<div id="home">
    <h1>Bible Type</h1>
    <p>Type God‚Äôs Word. Improve speed and accuracy.</p>
    <button onclick="startGame()">Start Race</button>
</div>

<div id="game">
    <div id="track">
        <div id="car">üöó</div>
    </div>
    <div id="typing">
        <div id="verse"></div>
        <input id="input" placeholder="Start typing‚Ä¶" autocomplete="off">
    </div>
</div>

<div id="results">
    <h2>Race Complete üèÅ</h2>
    <p id="wpm"></p>
    <p id="accuracy"></p>
    <h3>Best WPM</h3>
    <p id="best"></p>
    <button onclick="location.reload()">Race Again</button>
</div>

<script>
// KJV (PUBLIC DOMAIN)
const verses = [
    "For God so loved the world, that he gave his only begotten Son, that whosoever believeth in him should not perish, but have everlasting life.",
    "The LORD is my shepherd; I shall not want.",
    "I can do all things through Christ which strengtheneth me."
];

let verse = "";
let startTime;
let finished = false;

const verseEl = document.getElementById("verse");
const inputEl = document.getElementById("input");
const carEl = document.getElementById("car");

function startGame() {
    verse = verses[Math.floor(Math.random() * verses.length)];
    document.getElementById("home").style.display = "none";
    document.getElementById("game").style.display = "block";
    verseEl.innerHTML = verse;
    inputEl.value = "";
    inputEl.focus();
    startTime = new Date();
}

inputEl.addEventListener("input", () => {
    if (finished) return;

    let html = "";
    let correct = 0;

    for (let i = 0; i < verse.length; i++) {
        if (inputEl.value[i] === verse[i]) {
            html += `<span class="correct">${verse[i]}</span>`;
            correct++;
        } else if (inputEl.value[i]) {
            html += `<span class="incorrect">${verse[i]}</span>`;
        } else {
            html += verse[i];
        }
    }

    verseEl.innerHTML = html;

    const progress = correct / verse.length;
    carEl.style.left = 20 + progress * (window.innerWidth - 100) + "px";

    if (inputEl.value === verse) finish(correct);
});

function finish(correct) {
    finished = true;
    document.getElementById("game").style.display = "none";
    document.getElementById("results").style.display = "flex";

    const minutes = (new Date() - startTime) / 60000;
    const wpm = Math.round((verse.split(" ").length) / minutes);
    const accuracy = Math.round((correct / verse.length) * 100);

    document.getElementById("wpm").textContent = `WPM: ${wpm}`;
    document.getElementById("accuracy").textContent = `Accuracy: ${accuracy}%`;

    const best = Math.max(wpm, localStorage.getItem("bestWPM") || 0);
    localStorage.setItem("bestWPM", best);
    document.getElementById("best").textContent = best;
}
</script>

</body>
</html>
